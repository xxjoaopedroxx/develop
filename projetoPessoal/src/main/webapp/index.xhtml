<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<script type="text/javascript">
		//<![CDATA[
		function start() {
			PF('statusDialog').show();
		}

		function stop() {
			PF('statusDialog').hide();
		}
		//]]>
	</script>
</h:head>

<h:body>

	<h:form enctype="multipart/form-data">
		<p:fileUpload value="#{uploadBean.uploadedFile}" mode="simple"
			skinSimple="true" />

		<p:commandButton value="Enviar" ajax="false"
			actionListener="#{uploadBean.upload}" />
	</h:form>
	<p:dialog modal="true" widgetVar="statusDialog" header="Status"
		draggable="false" closable="false" resizable="false">
		<p:graphicImage name="/demo/images/ajaxloadingbar.gif" />
	</p:dialog>
	<h:form>
		<p:commandButton value="Baixar" ajax="false"
			onclick="PrimeFaces.monitorDownload(start, stop);"
			icon="pi pi-arrow-down">
			<p:fileDownload value="#{downloadBean.file}" />
		</p:commandButton>
	</h:form>

</h:body>
</html>